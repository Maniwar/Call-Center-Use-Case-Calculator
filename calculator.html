<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Contact Center ROI Calculator - Advanced Edition</title>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel Standalone for JSX -->
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
    
    <!-- Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Loading spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3B82F6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 100px auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Print styles */
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background: white !important;
            }
        }
        
        /* Chart container styles */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* Icon styles */
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            vertical-align: middle;
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 350px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 12px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -175px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.5;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Tab styles */
        .tab-active {
            background-color: #3B82F6;
            color: white;
        }
        
        .tab-inactive {
            background-color: #E5E7EB;
            color: #374151;
        }
        
        .tab-inactive:hover {
            background-color: #D1D5DB;
        }
        
        /* Table styles */
        .analytics-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .analytics-table th {
            background-color: #F3F4F6;
            padding: 8px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #E5E7EB;
        }
        
        .analytics-table td {
            padding: 8px;
            border-bottom: 1px solid #E5E7EB;
        }
        
        .analytics-table tr:hover {
            background-color: #F9FAFB;
        }
        
        /* Filter button styles */
        .filter-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .filter-btn-active {
            background-color: #3B82F6;
            color: white;
        }
        
        .filter-btn-inactive {
            background-color: white;
            color: #374151;
            border: 1px solid #D1D5DB;
        }
        
        .filter-btn-inactive:hover {
            background-color: #F3F4F6;
        }
        
        /* Guidance section styles */
        .guidance-card {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #3B82F6;
        }
        
        .guidance-title {
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .guidance-content {
            color: #4B5563;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .example-box {
            background: #F3F4F6;
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
            font-size: 13px;
        }
        
        .metric-guide {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 12px;
            margin-top: 8px;
        }
        
        .metric-item {
            background: #F9FAFB;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #E5E7EB;
        }
        
        .metric-label {
            font-weight: 600;
            color: #374151;
            font-size: 12px;
            margin-bottom: 4px;
        }
        
        .metric-value {
            color: #059669;
            font-weight: 500;
            font-size: 14px;
        }
        
        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 24px;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            cursor: pointer;
            background: #F3F4F6;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            background: #E5E7EB;
        }
        
        /* Settings panel styles */
        .settings-section {
            background: #F9FAFB;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }
        
        .settings-item {
            display: flex;
            flex-direction: column;
        }
        
        .settings-label {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }
        
        .settings-input {
            padding: 6px 10px;
            border: 1px solid #D1D5DB;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .settings-input:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Month selector styles */
        .month-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: #F3F4F6;
            border-radius: 6px;
        }
        
        .month-tag {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            background: white;
            border: 1px solid #D1D5DB;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .month-remove {
            cursor: pointer;
            color: #EF4444;
            font-weight: bold;
        }
        
        .month-remove:hover {
            color: #DC2626;
        }
        
        /* Date range picker styles */
        .date-range-picker {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 12px;
            background: #F9FAFB;
            border-radius: 8px;
        }
        
        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .date-label {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
        }
        
        .date-input {
            padding: 6px 10px;
            border: 1px solid #D1D5DB;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* Cost type toggle */
        .cost-type-toggle {
            display: inline-flex;
            background: #E5E7EB;
            border-radius: 6px;
            padding: 2px;
        }
        
        .cost-type-btn {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .cost-type-btn-active {
            background: white;
            color: #1F2937;
            font-weight: 600;
        }
        
        .cost-type-btn-inactive {
            background: transparent;
            color: #6B7280;
        }
        
        .cost-type-btn-inactive:hover {
            color: #374151;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="spinner"></div>
        <p style="text-align: center; margin-top: 20px; color: white;">Loading AI ROI Calculator...</p>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Simple SVG icons as components
        const Icons = {
            Download: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
                </svg>
            ),
            Upload: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
            ),
            Plus: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                </svg>
            ),
            Trash: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
            ),
            Settings: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            ),
            Chart: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
            ),
            Save: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V2" />
                </svg>
            ),
            Clear: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
            ),
            Help: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            ),
            FileText: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
            ),
            Info: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            ),
            Close: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                </svg>
            ),
            Calendar: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
            ),
            Dollar: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            ),
            Clock: () => (
                <svg className="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            )
        };

        // Input Guidance Data
        const InputGuidance = {
            "Deflection Rate (%)": {
                baseline: {
                    description: "Current % of contacts that are already being deflected by existing automation (if any)",
                    typical: "0-10%",
                    example: "If you already have a basic FAQ bot handling 5% of queries, enter 5"
                },
                volume: {
                    description: "Number of simple, repetitive contacts that AI could potentially handle",
                    calculation: "Total contacts × % that are simple/repetitive",
                    example: "10,000 monthly chats × 40% simple = 4,000 volume"
                },
                improvement: {
                    description: "Expected % of the volume that AI will successfully handle without agent",
                    typical: "60-80%",
                    example: "If AI can handle 70% of the 4,000 simple queries, enter 70"
                },
                industryBenchmarks: {
                    "Password Resets": "85-95%",
                    "Order Status": "75-85%",
                    "FAQs": "70-80%",
                    "Account Balance": "80-90%"
                }
            },
            "AHT Reduction (min)": {
                baseline: {
                    description: "Minutes already saved by current tools/processes (if any)",
                    typical: "0-1 min",
                    example: "If current tools save 0.5 minutes, enter 0.5"
                },
                volume: {
                    description: "Number of agent-handled contacts where AI co-pilot will assist",
                    calculation: "Total agent contacts that need assistance",
                    example: "5,000 complex calls requiring agent assistance"
                },
                improvement: {
                    description: "Minutes saved per contact through AI assistance",
                    typical: "1.5-3 min",
                    example: "AI helps save 2 minutes per call, enter 2"
                },
                industryBenchmarks: {
                    "Knowledge Suggestions": "1-2 min",
                    "Auto-fill Forms": "2-3 min",
                    "Sentiment Analysis": "0.5-1 min",
                    "Next Best Action": "1.5-2.5 min"
                }
            },
            "Automation Rate (%)": {
                baseline: {
                    description: "Current % of processes that are already automated",
                    typical: "10-20%",
                    example: "If 15% of orders are processed automatically, enter 15"
                },
                volume: {
                    description: "Number of routine tasks that could be automated",
                    calculation: "Total routine/repetitive tasks",
                    example: "8,000 order status checks per month"
                },
                improvement: {
                    description: "Expected % that will be fully automated by AI",
                    typical: "50-70%",
                    example: "AI can automate 65% of routine tasks, enter 65"
                },
                industryBenchmarks: {
                    "Order Processing": "60-75%",
                    "Returns/Refunds": "50-65%",
                    "Appointment Scheduling": "70-85%",
                    "Document Processing": "55-70%"
                }
            },
            "Self-Service Resolution (%)": {
                baseline: {
                    description: "Current % resolved through existing self-service",
                    typical: "10-25%",
                    example: "If current portal resolves 20%, enter 20"
                },
                volume: {
                    description: "Number of contacts attempting self-service",
                    calculation: "Contacts that try self-service first",
                    example: "3,000 customers trying to self-serve"
                },
                improvement: {
                    description: "Expected % that AI will help resolve without agent",
                    typical: "40-60%",
                    example: "AI improves resolution to 55%, enter 55"
                },
                industryBenchmarks: {
                    "Product Comparisons": "45-60%",
                    "Troubleshooting": "40-55%",
                    "Account Management": "50-65%",
                    "Policy Information": "60-75%"
                }
            },
            "Transfer Rate Reduction (%)": {
                baseline: {
                    description: "Current transfer rate between agents/departments",
                    typical: "25-35%",
                    example: "If 30% of calls are transferred, enter 30"
                },
                volume: {
                    description: "Number of contacts that currently get transferred",
                    calculation: "Total contacts × current transfer rate",
                    example: "10,000 calls × 30% transfer rate = 3,000"
                },
                improvement: {
                    description: "Expected reduction in transfer rate",
                    typical: "30-50%",
                    example: "Reduce transfers by 40%, enter 40"
                },
                industryBenchmarks: {
                    "Smart Routing": "35-45%",
                    "Intent Detection": "40-50%",
                    "Skill-based Routing": "30-40%",
                    "Context Preservation": "45-55%"
                }
            }
        };

        const AIValueCalculator = () => {
            // Initialize with reasonable defaults
            const generateMonthsFromRange = (startDate, endDate) => {
                const months = [];
                const current = new Date(startDate);
                const end = new Date(endDate);
                
                while (current <= end) {
                    months.push({
                        id: `${current.getFullYear()}-${String(current.getMonth() + 1).padStart(2, '0')}`,
                        year: current.getFullYear(),
                        month: current.toLocaleString('default', { month: 'short' })
                    });
                    current.setMonth(current.getMonth() + 1);
                }
                return months;
            };

            // Load saved data or use defaults
            const loadFromStorage = () => {
                try {
                    const savedData = localStorage.getItem('aiValueCalculatorData');
                    if (savedData) {
                        const parsed = JSON.parse(savedData);
                        return {
                            channelCosts: parsed.channelCosts || {
                                phone: 6.00,
                                chat: 2.50,
                                email: 4.00,
                                social: 3.00,
                                bot: 0.50
                            },
                            categoryCosts: parsed.categoryCosts || {
                                'Pre-Sales': { costType: 'perContact', value: 5.00 },
                                'Order Support': { costType: 'perContact', value: 6.00 },
                                'Technical Support': { costType: 'hourly', value: 35.00 },
                                'Customer Service': { costType: 'perContact', value: 4.50 }
                            },
                            specialGroups: parsed.specialGroups || {
                                'Tier 1 Agents': { costType: 'hourly', value: 25.00 },
                                'Tier 2 Agents': { costType: 'hourly', value: 35.00 },
                                'Specialists': { costType: 'hourly', value: 45.00 },
                                'Offshore': { costType: 'perContact', value: 2.00 }
                            },
                            useCases: parsed.useCases || [],
                            dateRange: parsed.dateRange || {
                                start: new Date().toISOString().slice(0, 7),
                                end: new Date(new Date().setMonth(new Date().getMonth() + 11)).toISOString().slice(0, 7)
                            }
                        };
                    }
                } catch (error) {
                    console.error('Error loading saved data:', error);
                }
                
                const currentDate = new Date();
                const defaultStart = currentDate.toISOString().slice(0, 7);
                const defaultEnd = new Date(currentDate.setMonth(currentDate.getMonth() + 11)).toISOString().slice(0, 7);
                
                // Return sensible defaults with example data
                return {
                    channelCosts: {
                        phone: 6.00,
                        chat: 2.50,
                        email: 4.00,
                        social: 3.00,
                        bot: 0.50
                    },
                    categoryCosts: {
                        'Pre-Sales': { costType: 'perContact', value: 5.00 },
                        'Order Support': { costType: 'perContact', value: 6.00 },
                        'Technical Support': { costType: 'hourly', value: 35.00 },
                        'Customer Service': { costType: 'perContact', value: 4.50 }
                    },
                    specialGroups: {
                        'Tier 1 Agents': { costType: 'hourly', value: 25.00 },
                        'Tier 2 Agents': { costType: 'hourly', value: 35.00 },
                        'Specialists': { costType: 'hourly', value: 45.00 },
                        'Offshore': { costType: 'perContact', value: 2.00 }
                    },
                    useCases: [
                        {
                            id: 'uc1',
                            category: 'Pre-Sales',
                            name: 'Answer Bot - General Q&A',
                            channel: 'chat',
                            metric: 'Deflection Rate (%)',
                            baselineValue: 0,
                            specialGroup: null,
                            data: {}
                        },
                        {
                            id: 'uc2',
                            category: 'Pre-Sales',
                            name: 'Product Comparison Bot',
                            channel: 'chat',
                            metric: 'Self-Service Resolution (%)',
                            baselineValue: 10,
                            specialGroup: null,
                            data: {}
                        },
                        {
                            id: 'uc3',
                            category: 'Pre-Sales',
                            name: 'Sales Co-Pilot',
                            channel: 'phone',
                            metric: 'AHT Reduction (min)',
                            baselineValue: 0,
                            specialGroup: 'Tier 1 Agents',
                            data: {}
                        },
                        {
                            id: 'uc4',
                            category: 'Order Support',
                            name: 'Order Status Automation',
                            channel: 'email',
                            metric: 'Automation Rate (%)',
                            baselineValue: 20,
                            specialGroup: null,
                            data: {}
                        },
                        {
                            id: 'uc5',
                            category: 'Order Support',
                            name: 'Returns Co-Pilot',
                            channel: 'phone',
                            metric: 'AHT Reduction (min)',
                            baselineValue: 0,
                            specialGroup: 'Tier 2 Agents',
                            data: {}
                        }
                    ],
                    dateRange: {
                        start: defaultStart,
                        end: defaultEnd
                    }
                };
            };

            const initialData = loadFromStorage();
            
            // State management
            const [channelCosts, setChannelCosts] = useState(initialData.channelCosts);
            const [categoryCosts, setCategoryCosts] = useState(initialData.categoryCosts);
            const [specialGroups, setSpecialGroups] = useState(initialData.specialGroups);
            const [useCases, setUseCases] = useState(initialData.useCases);
            const [dateRange, setDateRange] = useState(initialData.dateRange);
            const [months, setMonths] = useState(generateMonthsFromRange(initialData.dateRange.start, initialData.dateRange.end));
            const [activeTab, setActiveTab] = useState('data');
            const [analyticsView, setAnalyticsView] = useState('overall');
            const [analyticsDateRange, setAnalyticsDateRange] = useState({ ...initialData.dateRange });
            const [selectedCategory, setSelectedCategory] = useState('all');
            const [selectedChannel, setSelectedChannel] = useState('all');
            const [showSettings, setShowSettings] = useState(false);
            const [showAddUseCase, setShowAddUseCase] = useState(false);
            const [showGuidanceModal, setShowGuidanceModal] = useState(false);
            const [selectedMetricGuide, setSelectedMetricGuide] = useState(null);
            const [lastSaved, setLastSaved] = useState(new Date());
            const [showSaveIndicator, setShowSaveIndicator] = useState(false);
            
            const fileInputRef = useRef(null);
            const chartRefs = {
                monthly: useRef(null),
                cumulative: useRef(null),
                category: useRef(null),
                channel: useRef(null)
            };
            const chartInstances = useRef({});

            const [newUseCase, setNewUseCase] = useState({
                category: 'Pre-Sales',
                name: '',
                channel: 'phone',
                metric: 'Deflection Rate (%)',
                baselineValue: 0,
                specialGroup: null
            });

            const [newSpecialGroup, setNewSpecialGroup] = useState({
                name: '',
                costType: 'hourly',
                value: 30.00
            });

            // Update months when date range changes
            useEffect(() => {
                setMonths(generateMonthsFromRange(dateRange.start, dateRange.end));
            }, [dateRange]);

            // Auto-save functionality
            useEffect(() => {
                const saveTimeout = setTimeout(() => {
                    try {
                        const dataToSave = {
                            channelCosts,
                            categoryCosts,
                            specialGroups,
                            useCases,
                            dateRange,
                            savedAt: new Date().toISOString()
                        };
                        localStorage.setItem('aiValueCalculatorData', JSON.stringify(dataToSave));
                        setLastSaved(new Date());
                        setShowSaveIndicator(true);
                        setTimeout(() => setShowSaveIndicator(false), 2000);
                    } catch (error) {
                        console.error('Save error:', error);
                    }
                }, 1000);

                return () => clearTimeout(saveTimeout);
            }, [channelCosts, categoryCosts, specialGroups, useCases, dateRange]);

            // Calculate cost based on category and special group
            const getEffectiveCost = (useCase, channel) => {
                // Priority: Special Group > Category > Channel
                if (useCase.specialGroup && specialGroups[useCase.specialGroup]) {
                    const group = specialGroups[useCase.specialGroup];
                    if (group.costType === 'perContact') {
                        return group.value;
                    }
                    // For hourly, we'll use it later in calculations
                    return group.value;
                }
                
                if (categoryCosts[useCase.category]) {
                    const categoryCost = categoryCosts[useCase.category];
                    if (categoryCost.costType === 'perContact') {
                        return categoryCost.value;
                    }
                    // For hourly, we'll use it later
                    return categoryCost.value;
                }
                
                return channelCosts[channel] || 0;
            };

            // Calculate savings with proper formulas
            const calculateSavings = (useCase, monthId) => {
                const monthData = useCase.data[monthId] || {};
                const volume = parseFloat(monthData.volume) || 0;
                const improvement = parseFloat(monthData.improvement) || 0;
                const baseline = parseFloat(useCase.baselineValue) || 0;
                
                // Calculate net improvement (improvement - baseline)
                const netImprovement = Math.max(0, improvement - baseline);
                
                // Get the effective cost
                let effectiveCost = getEffectiveCost(useCase, useCase.channel);
                let isHourly = false;
                
                // Check if we're using hourly rate
                if (useCase.specialGroup && specialGroups[useCase.specialGroup]) {
                    isHourly = specialGroups[useCase.specialGroup].costType === 'hourly';
                } else if (categoryCosts[useCase.category]) {
                    isHourly = categoryCosts[useCase.category].costType === 'hourly';
                }
                
                // Different calculation based on metric type
                if (useCase.metric.includes('AHT Reduction')) {
                    // For AHT, always use hourly rate
                    if (!isHourly) {
                        // Convert per-contact cost to approximate hourly (assume 10 min avg call)
                        effectiveCost = effectiveCost * 6; // 6 calls per hour
                    }
                    return volume * (netImprovement / 60) * effectiveCost;
                } else if (useCase.metric.includes('Deflection') || useCase.metric.includes('Automation')) {
                    // For deflection/automation, use per-contact cost
                    if (isHourly) {
                        // Convert hourly to per-contact (assume 10 min avg)
                        effectiveCost = effectiveCost / 6;
                    }
                    return volume * (netImprovement / 100) * effectiveCost;
                } else if (useCase.metric.includes('Resolution') || useCase.metric.includes('Transfer')) {
                    // For resolution/transfer, use per-contact cost
                    if (isHourly) {
                        // Convert hourly to per-contact
                        effectiveCost = effectiveCost / 6;
                    }
                    return volume * (netImprovement / 100) * effectiveCost;
                }
                return 0;
            };

            const calculateTotalSavings = () => {
                let total = 0;
                const filteredUseCases = getFilteredUseCases();
                const filteredMonths = getFilteredMonths();
                
                filteredUseCases.forEach(uc => {
                    filteredMonths.forEach(month => {
                        total += calculateSavings(uc, month.id);
                    });
                });
                return total;
            };

            // Get filtered months for analytics
            const getFilteredMonths = () => {
                if (activeTab === 'analytics' && analyticsDateRange) {
                    return generateMonthsFromRange(analyticsDateRange.start, analyticsDateRange.end);
                }
                return months;
            };

            // Get filtered use cases based on current view
            const getFilteredUseCases = () => {
                let filtered = useCases;
                if (selectedCategory !== 'all') {
                    filtered = filtered.filter(uc => uc.category === selectedCategory);
                }
                if (selectedChannel !== 'all') {
                    filtered = filtered.filter(uc => uc.channel === selectedChannel);
                }
                return filtered;
            };

            // Get unique categories
            const getCategories = () => {
                const categories = new Set(useCases.map(uc => uc.category));
                return Array.from(categories);
            };

            // Get unique channels
            const getChannels = () => {
                const channels = new Set(useCases.map(uc => uc.channel));
                return Array.from(channels);
            };

            // Chart data preparation
            const getMonthlyTrendData = () => {
                const filteredUseCases = getFilteredUseCases();
                const filteredMonths = getFilteredMonths();
                
                return filteredMonths.map(month => {
                    let monthTotal = 0;
                    filteredUseCases.forEach(uc => {
                        monthTotal += calculateSavings(uc, month.id);
                    });
                    return {
                        label: `${month.month} ${month.year}`,
                        value: Math.round(monthTotal)
                    };
                });
            };

            const getCumulativeData = () => {
                const filteredUseCases = getFilteredUseCases();
                const filteredMonths = getFilteredMonths();
                let cumulative = 0;
                
                return filteredMonths.map(month => {
                    let monthTotal = 0;
                    filteredUseCases.forEach(uc => {
                        monthTotal += calculateSavings(uc, month.id);
                    });
                    cumulative += monthTotal;
                    return {
                        label: `${month.month} ${month.year}`,
                        value: Math.round(cumulative)
                    };
                });
            };

            const getCategoryBreakdown = () => {
                const categories = {};
                const filteredUseCases = getFilteredUseCases();
                const filteredMonths = getFilteredMonths();
                
                filteredUseCases.forEach(uc => {
                    if (!categories[uc.category]) {
                        categories[uc.category] = 0;
                    }
                    filteredMonths.forEach(month => {
                        categories[uc.category] += calculateSavings(uc, month.id);
                    });
                });
                return Object.entries(categories).map(([name, value]) => ({
                    label: name,
                    value: Math.round(value)
                }));
            };

            const getChannelBreakdown = () => {
                const channels = {};
                const filteredUseCases = getFilteredUseCases();
                const filteredMonths = getFilteredMonths();
                
                filteredUseCases.forEach(uc => {
                    if (!channels[uc.channel]) {
                        channels[uc.channel] = 0;
                    }
                    filteredMonths.forEach(month => {
                        channels[uc.channel] += calculateSavings(uc, month.id);
                    });
                });
                return Object.entries(channels).map(([name, value]) => ({
                    label: name.charAt(0).toUpperCase() + name.slice(1),
                    value: Math.round(value)
                }));
            };

            // Initialize charts
            useEffect(() => {
                if (activeTab === 'analytics' && window.Chart) {
                    // Destroy existing charts
                    Object.values(chartInstances.current).forEach(chart => {
                        if (chart) chart.destroy();
                    });

                    // Monthly Trend Chart
                    if (chartRefs.monthly.current) {
                        const monthlyData = getMonthlyTrendData();
                        const ctx = chartRefs.monthly.current.getContext('2d');
                        chartInstances.current.monthly = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: monthlyData.map(d => d.label),
                                datasets: [{
                                    label: 'Monthly Savings',
                                    data: monthlyData.map(d => d.value),
                                    borderColor: '#3B82F6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { display: true },
                                    tooltip: {
                                        callbacks: {
                                            label: (context) => `Savings: $${context.parsed.y.toLocaleString()}`
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Cumulative Chart
                    if (chartRefs.cumulative.current) {
                        const cumulativeData = getCumulativeData();
                        const ctx = chartRefs.cumulative.current.getContext('2d');
                        chartInstances.current.cumulative = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: cumulativeData.map(d => d.label),
                                datasets: [{
                                    label: 'Cumulative Savings',
                                    data: cumulativeData.map(d => d.value),
                                    borderColor: '#10B981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { display: true },
                                    tooltip: {
                                        callbacks: {
                                            label: (context) => `Total: $${context.parsed.y.toLocaleString()}`
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Category Pie Chart
                    if (chartRefs.category.current) {
                        const categoryData = getCategoryBreakdown();
                        const ctx = chartRefs.category.current.getContext('2d');
                        chartInstances.current.category = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: categoryData.map(d => d.label),
                                datasets: [{
                                    data: categoryData.map(d => d.value),
                                    backgroundColor: [
                                        '#3B82F6',
                                        '#10B981',
                                        '#F59E0B',
                                        '#EF4444',
                                        '#8B5CF6'
                                    ]
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { position: 'bottom' },
                                    tooltip: {
                                        callbacks: {
                                            label: (context) => `${context.label}: $${context.parsed.toLocaleString()}`
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Channel Bar Chart
                    if (chartRefs.channel.current) {
                        const channelData = getChannelBreakdown();
                        const ctx = chartRefs.channel.current.getContext('2d');
                        chartInstances.current.channel = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: channelData.map(d => d.label),
                                datasets: [{
                                    label: 'Channel Savings',
                                    data: channelData.map(d => d.value),
                                    backgroundColor: '#8B5CF6'
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { display: false },
                                    tooltip: {
                                        callbacks: {
                                            label: (context) => `Savings: $${context.parsed.y.toLocaleString()}`
                                        }
                                    }
                                }
                            }
                        });
                    }
                }

                return () => {
                    Object.values(chartInstances.current).forEach(chart => {
                        if (chart) chart.destroy();
                    });
                };
            }, [activeTab, useCases, months, channelCosts, categoryCosts, specialGroups, selectedCategory, selectedChannel, analyticsDateRange]);

            // CRUD Operations
            const addUseCase = () => {
                if (newUseCase.name) {
                    setUseCases([...useCases, {
                        id: `uc${Date.now()}`,
                        ...newUseCase,
                        data: {}
                    }]);
                    setNewUseCase({
                        category: 'Pre-Sales',
                        name: '',
                        channel: 'phone',
                        metric: 'Deflection Rate (%)',
                        baselineValue: 0,
                        specialGroup: null
                    });
                    setShowAddUseCase(false);
                }
            };

            const removeUseCase = (id) => {
                setUseCases(useCases.filter(uc => uc.id !== id));
            };

            const updateUseCaseData = (useCaseId, monthId, field, value) => {
                setUseCases(useCases.map(uc => {
                    if (uc.id === useCaseId) {
                        return {
                            ...uc,
                            data: {
                                ...uc.data,
                                [monthId]: {
                                    ...uc.data[monthId],
                                    [field]: value
                                }
                            }
                        };
                    }
                    return uc;
                }));
            };

            const addSpecialGroup = () => {
                if (newSpecialGroup.name) {
                    setSpecialGroups({
                        ...specialGroups,
                        [newSpecialGroup.name]: {
                            costType: newSpecialGroup.costType,
                            value: newSpecialGroup.value
                        }
                    });
                    setNewSpecialGroup({
                        name: '',
                        costType: 'hourly',
                        value: 30.00
                    });
                }
            };

            const removeSpecialGroup = (name) => {
                const newGroups = { ...specialGroups };
                delete newGroups[name];
                setSpecialGroups(newGroups);
                
                // Update use cases that were using this group
                setUseCases(useCases.map(uc => 
                    uc.specialGroup === name ? { ...uc, specialGroup: null } : uc
                ));
            };

            // Import/Export functionality
            const exportToCSV = () => {
                let csv = '=== AI ROI CALCULATOR FULL EXPORT ===\n';
                csv += `Export Date: ${new Date().toISOString()}\n`;
                csv += `Analysis Period: ${dateRange.start} to ${dateRange.end}\n`;
                csv += `Total Months: ${months.length}\n\n`;
                
                // SECTION 1: DETAILED USE CASE DATA
                csv += '=== SECTION 1: USE CASE SAVINGS CALCULATIONS ===\n';
                csv += 'Category,Use Case,Channel,Metric,Special Group,Baseline,Effective Cost,Cost Type';
                
                months.forEach(month => {
                    csv += `,${month.year}-${month.month} Volume,${month.year}-${month.month} Improvement,${month.year}-${month.month} Net Improvement,${month.year}-${month.month} Savings`;
                });
                csv += ',Total Savings\n';
                
                useCases.forEach(uc => {
                    // Determine effective cost and type
                    let effectiveCost = getEffectiveCost(uc, uc.channel);
                    let costSource = 'Channel Default';
                    let costType = 'Per Contact';
                    
                    if (uc.specialGroup && specialGroups[uc.specialGroup]) {
                        costSource = `Special Group: ${uc.specialGroup}`;
                        costType = specialGroups[uc.specialGroup].costType === 'hourly' ? 'Hourly' : 'Per Contact';
                    } else if (categoryCosts[uc.category]) {
                        costSource = `Category: ${uc.category}`;
                        costType = categoryCosts[uc.category].costType === 'hourly' ? 'Hourly' : 'Per Contact';
                    }
                    
                    csv += `${uc.category},${uc.name},${uc.channel},${uc.metric},${uc.specialGroup || 'None'},${uc.baselineValue},${effectiveCost},${costType}`;
                    
                    let totalSavings = 0;
                    
                    months.forEach(month => {
                        const monthData = uc.data[month.id] || {};
                        const improvement = monthData.improvement || 0;
                        const netImprovement = Math.max(0, improvement - uc.baselineValue);
                        const savings = calculateSavings(uc, month.id);
                        totalSavings += savings;
                        csv += `,${monthData.volume || 0},${improvement},${netImprovement},${savings.toFixed(2)}`;
                    });
                    csv += `,${totalSavings.toFixed(2)}\n`;
                });
                
                // SECTION 2: INPUT PARAMETERS
                csv += '\n\n=== SECTION 2: ALL INPUT PARAMETERS ===\n';
                csv += 'Use Case,Month,Volume Input,Improvement Input,Baseline,Net Improvement Used\n';
                
                useCases.forEach(uc => {
                    months.forEach(month => {
                        const monthData = uc.data[month.id] || {};
                        const improvement = monthData.improvement || 0;
                        const netImprovement = Math.max(0, improvement - uc.baselineValue);
                        csv += `${uc.name},${month.month} ${month.year},${monthData.volume || 0},${improvement},${uc.baselineValue},${netImprovement}\n`;
                    });
                });
                
                // SECTION 3: COST SETTINGS
                csv += '\n\n=== SECTION 3: COST CONFIGURATION ===\n';
                csv += 'Cost Tier,Type,Name,Cost Type,Value,Priority\n';
                
                // Channel costs (Priority 3)
                Object.entries(channelCosts).forEach(([channel, cost]) => {
                    csv += `Channel Default,Channel,${channel},Per Contact,${cost},Priority 3 (Lowest)\n`;
                });
                
                // Category costs (Priority 2)
                Object.entries(categoryCosts).forEach(([category, data]) => {
                    csv += `Category Override,Category,${category},${data.costType === 'hourly' ? 'Hourly' : 'Per Contact'},${data.value},Priority 2 (Medium)\n`;
                });
                
                // Special groups (Priority 1)
                Object.entries(specialGroups).forEach(([group, data]) => {
                    csv += `Special Group,Special Group,${group},${data.costType === 'hourly' ? 'Hourly' : 'Per Contact'},${data.value},Priority 1 (Highest)\n`;
                });
                
                // SECTION 4: CALCULATION FORMULAS
                csv += '\n\n=== SECTION 4: CALCULATION FORMULAS USED ===\n';
                csv += 'Metric Type,Formula,Example\n';
                csv += 'Deflection Rate (%),Volume × (Improvement% - Baseline%) × Cost per Contact,"1000 × (70% - 10%) × $2.50 = $1,500"\n';
                csv += 'AHT Reduction (min),Volume × (Minutes - Baseline) / 60 × Hourly Rate,"500 × (3 - 0.5) / 60 × $30 = $625"\n';
                csv += 'Automation Rate (%),Volume × (Improvement% - Baseline%) × Cost per Contact,"2000 × (60% - 20%) × $4 = $3,200"\n';
                csv += 'Self-Service Resolution (%),Volume × (Improvement% - Baseline%) × Cost per Contact,"1500 × (50% - 15%) × $3 = $1,575"\n';
                csv += 'Transfer Rate Reduction (%),Volume × (Reduction% - Baseline%) × Cost per Contact,"3000 × (40% - 30%) × $6 = $1,800"\n';
                
                // SECTION 5: MONTHLY SUMMARY
                csv += '\n\n=== SECTION 5: MONTHLY SAVINGS SUMMARY ===\n';
                csv += 'Month,Total Volume,Total Savings,Cumulative Savings\n';
                
                let cumulative = 0;
                months.forEach(month => {
                    let monthVolume = 0;
                    let monthSavings = 0;
                    useCases.forEach(uc => {
                        const monthData = uc.data[month.id] || {};
                        monthVolume += parseFloat(monthData.volume) || 0;
                        monthSavings += calculateSavings(uc, month.id);
                    });
                    cumulative += monthSavings;
                    csv += `${month.month} ${month.year},${monthVolume},${monthSavings.toFixed(2)},${cumulative.toFixed(2)}\n`;
                });
                
                // SECTION 6: CATEGORY BREAKDOWN
                csv += '\n\n=== SECTION 6: SAVINGS BY CATEGORY ===\n';
                csv += 'Category,Total Volume,Total Savings,% of Total\n';
                
                const categoryTotals = {};
                const categoryVolumes = {};
                useCases.forEach(uc => {
                    if (!categoryTotals[uc.category]) {
                        categoryTotals[uc.category] = 0;
                        categoryVolumes[uc.category] = 0;
                    }
                    months.forEach(month => {
                        const monthData = uc.data[month.id] || {};
                        categoryVolumes[uc.category] += parseFloat(monthData.volume) || 0;
                        categoryTotals[uc.category] += calculateSavings(uc, month.id);
                    });
                });
                
                const totalSavingsAll = calculateTotalSavings();
                Object.entries(categoryTotals).forEach(([category, savings]) => {
                    const percentage = totalSavingsAll > 0 ? (savings / totalSavingsAll * 100).toFixed(1) : 0;
                    csv += `${category},${categoryVolumes[category]},${savings.toFixed(2)},${percentage}%\n`;
                });
                
                // SECTION 7: CHANNEL BREAKDOWN
                csv += '\n\n=== SECTION 7: SAVINGS BY CHANNEL ===\n';
                csv += 'Channel,Total Volume,Total Savings,Default Cost,% of Total\n';
                
                const channelTotals = {};
                const channelVolumes = {};
                useCases.forEach(uc => {
                    if (!channelTotals[uc.channel]) {
                        channelTotals[uc.channel] = 0;
                        channelVolumes[uc.channel] = 0;
                    }
                    months.forEach(month => {
                        const monthData = uc.data[month.id] || {};
                        channelVolumes[uc.channel] += parseFloat(monthData.volume) || 0;
                        channelTotals[uc.channel] += calculateSavings(uc, month.id);
                    });
                });
                
                Object.entries(channelTotals).forEach(([channel, savings]) => {
                    const percentage = totalSavingsAll > 0 ? (savings / totalSavingsAll * 100).toFixed(1) : 0;
                    csv += `${channel},${channelVolumes[channel]},${savings.toFixed(2)},${channelCosts[channel]},${percentage}%\n`;
                });
                
                // SECTION 8: EXECUTIVE SUMMARY
                csv += '\n\n=== SECTION 8: EXECUTIVE SUMMARY ===\n';
                csv += 'Metric,Value\n';
                csv += `Total Projected Savings,$${calculateTotalSavings().toFixed(2)}\n`;
                csv += `Average Monthly Savings,$${(calculateTotalSavings() / months.length).toFixed(2)}\n`;
                csv += `Total Use Cases,${useCases.length}\n`;
                csv += `Analysis Period,"${dateRange.start} to ${dateRange.end}"\n`;
                csv += `Number of Months,${months.length}\n`;
                csv += `Total Volume Processed,${Object.values(channelVolumes).reduce((a, b) => a + b, 0)}\n`;
                csv += `Average Cost per Contact Saved,$${totalSavingsAll > 0 ? (totalSavingsAll / Object.values(channelVolumes).reduce((a, b) => a + b, 0) || 1).toFixed(2) : 0}\n`;
                
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `roi_analysis_complete_${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            };

            const exportToJSON = () => {
                const dataToExport = {
                    channelCosts,
                    categoryCosts,
                    specialGroups,
                    useCases,
                    dateRange,
                    exportDate: new Date().toISOString(),
                    version: '2.0'
                };
                
                const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `roi_backup_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                window.URL.revokeObjectURL(url);
            };

            const importJSON = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            
                            // Validate and import data
                            if (importedData.channelCosts) setChannelCosts(importedData.channelCosts);
                            if (importedData.categoryCosts) setCategoryCosts(importedData.categoryCosts);
                            if (importedData.specialGroups) setSpecialGroups(importedData.specialGroups);
                            if (importedData.useCases) setUseCases(importedData.useCases);
                            if (importedData.dateRange) {
                                setDateRange(importedData.dateRange);
                                setMonths(generateMonthsFromRange(importedData.dateRange.start, importedData.dateRange.end));
                            }
                            
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing file. Please ensure it\'s a valid JSON backup file.');
                            console.error('Import error:', error);
                        }
                    };
                    reader.readAsText(file);
                }
                // Reset the file input
                event.target.value = '';
            };

            const clearAllData = () => {
                if (window.confirm('Clear all data? This cannot be undone.')) {
                    localStorage.removeItem('aiValueCalculatorData');
                    window.location.reload();
                }
            };

            // Guidance Modal Component
            const GuidanceModal = () => {
                if (!showGuidanceModal || !selectedMetricGuide) return null;
                
                const guide = InputGuidance[selectedMetricGuide];
                if (!guide) return null;
                
                return (
                    <div className="modal-overlay" onClick={() => setShowGuidanceModal(false)}>
                        <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                            <div className="modal-close" onClick={() => setShowGuidanceModal(false)}>
                                <Icons.Close />
                            </div>
                            
                            <h2 className="text-2xl font-bold mb-4 text-gray-800">
                                Input Guide: {selectedMetricGuide}
                            </h2>
                            
                            <div className="space-y-4">
                                <div className="guidance-card">
                                    <div className="guidance-title">📊 Baseline Value</div>
                                    <div className="guidance-content">
                                        <p>{guide.baseline.description}</p>
                                        <div className="metric-guide">
                                            <div className="metric-item">
                                                <div className="metric-label">Typical Range</div>
                                                <div className="metric-value">{guide.baseline.typical}</div>
                                            </div>
                                        </div>
                                        <div className="example-box">
                                            <strong>Example:</strong> {guide.baseline.example}
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="guidance-card">
                                    <div className="guidance-title">📈 Volume Input</div>
                                    <div className="guidance-content">
                                        <p>{guide.volume.description}</p>
                                        <div className="example-box">
                                            <strong>Calculation:</strong> {guide.volume.calculation}
                                        </div>
                                        <div className="example-box">
                                            <strong>Example:</strong> {guide.volume.example}
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="guidance-card">
                                    <div className="guidance-title">✅ Improvement Input</div>
                                    <div className="guidance-content">
                                        <p>{guide.improvement.description}</p>
                                        <div className="metric-guide">
                                            <div className="metric-item">
                                                <div className="metric-label">Typical Range</div>
                                                <div className="metric-value">{guide.improvement.typical}</div>
                                            </div>
                                        </div>
                                        <div className="example-box">
                                            <strong>Example:</strong> {guide.improvement.example}
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="guidance-card">
                                    <div className="guidance-title">🏆 Industry Benchmarks</div>
                                    <div className="guidance-content">
                                        <div className="grid grid-cols-2 gap-3">
                                            {Object.entries(guide.industryBenchmarks).map(([useCase, benchmark]) => (
                                                <div key={useCase} className="metric-item">
                                                    <div className="metric-label">{useCase}</div>
                                                    <div className="metric-value">{benchmark}</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800">AI Contact Center ROI Calculator</h1>
                                    <p className="text-gray-600 mt-2">Advanced cost modeling with category and group pricing</p>
                                    {showSaveIndicator && (
                                        <p className="text-green-600 text-sm mt-1 flex items-center gap-1">
                                            <Icons.Save /> Auto-saved
                                        </p>
                                    )}
                                </div>
                                <div className="flex gap-3 no-print">
                                    <button
                                        onClick={() => setShowSettings(!showSettings)}
                                        className="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"
                                    >
                                        <Icons.Settings /> Cost Settings
                                    </button>
                                    <button
                                        onClick={clearAllData}
                                        className="flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                                    >
                                        <Icons.Clear /> Clear All
                                    </button>
                                </div>
                            </div>
                            
                            {/* Tabs */}
                            <div className="flex gap-2 mb-4">
                                <button
                                    onClick={() => setActiveTab('data')}
                                    className={`px-4 py-2 rounded-lg ${activeTab === 'data' ? 'tab-active' : 'tab-inactive'}`}
                                >
                                    Data Entry
                                </button>
                                <button
                                    onClick={() => setActiveTab('analytics')}
                                    className={`px-4 py-2 rounded-lg ${activeTab === 'analytics' ? 'tab-active' : 'tab-inactive'}`}
                                >
                                    Analytics & Reports
                                </button>
                                <button
                                    onClick={() => setActiveTab('guidance')}
                                    className={`px-4 py-2 rounded-lg ${activeTab === 'guidance' ? 'tab-active' : 'tab-inactive'}`}
                                >
                                    Input Guidance
                                </button>
                            </div>
                            
                            {/* Action Buttons */}
                            {activeTab === 'data' && (
                                <div className="flex gap-3">
                                    <button
                                        onClick={exportToCSV}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                                    >
                                        <Icons.Download /> Export CSV
                                    </button>
                                    <button
                                        onClick={exportToJSON}
                                        className="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"
                                    >
                                        <Icons.FileText /> Backup JSON
                                    </button>
                                    <button
                                        onClick={() => fileInputRef.current.click()}
                                        className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                                    >
                                        <Icons.Upload /> Import JSON
                                    </button>
                                    <input
                                        ref={fileInputRef}
                                        type="file"
                                        accept=".json"
                                        onChange={importJSON}
                                        style={{ display: 'none' }}
                                    />
                                </div>
                            )}
                            
                            {/* Summary Cards */}
                            <div className="grid grid-cols-4 gap-4 mt-4">
                                <div className="bg-blue-50 rounded-lg p-4">
                                    <p className="text-blue-600 text-sm">Use Cases</p>
                                    <p className="text-2xl font-bold">{useCases.length}</p>
                                </div>
                                <div className="bg-green-50 rounded-lg p-4">
                                    <p className="text-green-600 text-sm">Months</p>
                                    <p className="text-2xl font-bold">{months.length}</p>
                                </div>
                                <div className="bg-purple-50 rounded-lg p-4">
                                    <p className="text-purple-600 text-sm">Monthly Avg</p>
                                    <p className="text-2xl font-bold">
                                        ${months.length > 0 ? Math.round(calculateTotalSavings() / months.length).toLocaleString() : 0}
                                    </p>
                                </div>
                                <div className="bg-yellow-50 rounded-lg p-4">
                                    <p className="text-yellow-600 text-sm">Total Savings</p>
                                    <p className="text-2xl font-bold">
                                        ${Math.round(calculateTotalSavings()).toLocaleString()}
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* Advanced Settings Panel */}
                        {showSettings && (
                            <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                                <h2 className="text-xl font-semibold mb-4">Advanced Cost Settings</h2>
                                
                                {/* Channel Costs */}
                                <div className="settings-section">
                                    <h3 className="font-semibold mb-3 flex items-center gap-2">
                                        <Icons.Dollar /> Channel Default Costs ($ per contact)
                                    </h3>
                                    <div className="settings-grid">
                                        {Object.entries(channelCosts).map(([channel, cost]) => (
                                            <div key={channel} className="settings-item">
                                                <label className="settings-label capitalize">{channel}</label>
                                                <input
                                                    type="number"
                                                    value={cost}
                                                    onChange={(e) => setChannelCosts({
                                                        ...channelCosts,
                                                        [channel]: parseFloat(e.target.value) || 0
                                                    })}
                                                    className="settings-input"
                                                    step="0.01"
                                                />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                {/* Category Costs */}
                                <div className="settings-section">
                                    <h3 className="font-semibold mb-3 flex items-center gap-2">
                                        <Icons.Chart /> Category-Specific Costs (overrides channel defaults)
                                    </h3>
                                    <div className="space-y-2">
                                        {Object.entries(categoryCosts).map(([category, data]) => (
                                            <div key={category} className="flex items-center gap-3">
                                                <span className="w-32 font-medium">{category}</span>
                                                <div className="cost-type-toggle">
                                                    <button
                                                        onClick={() => setCategoryCosts({
                                                            ...categoryCosts,
                                                            [category]: { ...data, costType: 'perContact' }
                                                        })}
                                                        className={`cost-type-btn ${data.costType === 'perContact' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                    >
                                                        Per Contact
                                                    </button>
                                                    <button
                                                        onClick={() => setCategoryCosts({
                                                            ...categoryCosts,
                                                            [category]: { ...data, costType: 'hourly' }
                                                        })}
                                                        className={`cost-type-btn ${data.costType === 'hourly' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                    >
                                                        Hourly
                                                    </button>
                                                </div>
                                                <input
                                                    type="number"
                                                    value={data.value}
                                                    onChange={(e) => setCategoryCosts({
                                                        ...categoryCosts,
                                                        [category]: { ...data, value: parseFloat(e.target.value) || 0 }
                                                    })}
                                                    className="settings-input w-24"
                                                    step="0.01"
                                                />
                                                <span className="text-sm text-gray-500">
                                                    ${data.value} {data.costType === 'hourly' ? '/hr' : '/contact'}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                {/* Special Groups */}
                                <div className="settings-section">
                                    <h3 className="font-semibold mb-3 flex items-center gap-2">
                                        <Icons.Clock /> Special Groups (overrides category costs)
                                    </h3>
                                    <div className="space-y-2">
                                        {Object.entries(specialGroups).map(([group, data]) => (
                                            <div key={group} className="flex items-center gap-3">
                                                <span className="w-32 font-medium">{group}</span>
                                                <div className="cost-type-toggle">
                                                    <button
                                                        onClick={() => setSpecialGroups({
                                                            ...specialGroups,
                                                            [group]: { ...data, costType: 'perContact' }
                                                        })}
                                                        className={`cost-type-btn ${data.costType === 'perContact' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                    >
                                                        Per Contact
                                                    </button>
                                                    <button
                                                        onClick={() => setSpecialGroups({
                                                            ...specialGroups,
                                                            [group]: { ...data, costType: 'hourly' }
                                                        })}
                                                        className={`cost-type-btn ${data.costType === 'hourly' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                    >
                                                        Hourly
                                                    </button>
                                                </div>
                                                <input
                                                    type="number"
                                                    value={data.value}
                                                    onChange={(e) => setSpecialGroups({
                                                        ...specialGroups,
                                                        [group]: { ...data, value: parseFloat(e.target.value) || 0 }
                                                    })}
                                                    className="settings-input w-24"
                                                    step="0.01"
                                                />
                                                <span className="text-sm text-gray-500">
                                                    ${data.value} {data.costType === 'hourly' ? '/hr' : '/contact'}
                                                </span>
                                                <button
                                                    onClick={() => removeSpecialGroup(group)}
                                                    className="text-red-600 hover:text-red-800"
                                                >
                                                    <Icons.Trash />
                                                </button>
                                            </div>
                                        ))}
                                        
                                        {/* Add Special Group */}
                                        <div className="flex items-center gap-3 pt-2 border-t">
                                            <input
                                                type="text"
                                                placeholder="Group Name"
                                                value={newSpecialGroup.name}
                                                onChange={(e) => setNewSpecialGroup({ ...newSpecialGroup, name: e.target.value })}
                                                className="settings-input w-32"
                                            />
                                            <div className="cost-type-toggle">
                                                <button
                                                    onClick={() => setNewSpecialGroup({ ...newSpecialGroup, costType: 'perContact' })}
                                                    className={`cost-type-btn ${newSpecialGroup.costType === 'perContact' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                >
                                                    Per Contact
                                                </button>
                                                <button
                                                    onClick={() => setNewSpecialGroup({ ...newSpecialGroup, costType: 'hourly' })}
                                                    className={`cost-type-btn ${newSpecialGroup.costType === 'hourly' ? 'cost-type-btn-active' : 'cost-type-btn-inactive'}`}
                                                >
                                                    Hourly
                                                </button>
                                            </div>
                                            <input
                                                type="number"
                                                value={newSpecialGroup.value}
                                                onChange={(e) => setNewSpecialGroup({ ...newSpecialGroup, value: parseFloat(e.target.value) || 0 })}
                                                className="settings-input w-24"
                                                step="0.01"
                                            />
                                            <button
                                                onClick={addSpecialGroup}
                                                className="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700"
                                            >
                                                Add Group
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Data Entry Tab */}
                        {activeTab === 'data' && (
                            <>
                                {/* Date Range Selector */}
                                <div className="bg-white rounded-lg shadow-lg p-4 mb-6">
                                    <h3 className="font-semibold mb-3 flex items-center gap-2">
                                        <Icons.Calendar /> Date Range for Analysis
                                    </h3>
                                    <div className="date-range-picker">
                                        <div className="date-input-group">
                                            <label className="date-label">Start Month</label>
                                            <input
                                                type="month"
                                                value={dateRange.start}
                                                onChange={(e) => setDateRange({ ...dateRange, start: e.target.value })}
                                                className="date-input"
                                            />
                                        </div>
                                        <div className="date-input-group">
                                            <label className="date-label">End Month</label>
                                            <input
                                                type="month"
                                                value={dateRange.end}
                                                onChange={(e) => setDateRange({ ...dateRange, end: e.target.value })}
                                                className="date-input"
                                            />
                                        </div>
                                        <div className="flex items-end">
                                            <div className="px-4 py-2 bg-blue-100 text-blue-700 rounded">
                                                {months.length} months selected
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                                    <div className="overflow-x-auto">
                                        <table className="w-full">
                                            <thead className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
                                                <tr>
                                                    <th className="px-4 py-3 text-left">Category</th>
                                                    <th className="px-4 py-3 text-left">Use Case</th>
                                                    <th className="px-4 py-3 text-left">Channel</th>
                                                    <th className="px-4 py-3 text-left">Special Group</th>
                                                    <th className="px-4 py-3 text-left">Metric</th>
                                                    <th className="px-4 py-3 text-left">Baseline</th>
                                                    {months.map(month => (
                                                        <th key={month.id} className="px-4 py-3 text-center min-w-[140px]">
                                                            {month.month} {month.year}
                                                        </th>
                                                    ))}
                                                    <th className="px-4 py-3 text-center">Total</th>
                                                    <th className="px-4 py-3 text-center">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {useCases.map((useCase, index) => {
                                                    const totalSavings = months.reduce((sum, month) => 
                                                        sum + calculateSavings(useCase, month.id), 0
                                                    );
                                                    
                                                    return (
                                                        <tr key={useCase.id} className={index % 2 === 0 ? 'bg-gray-50' : 'bg-white'}>
                                                            <td className="px-4 py-3">{useCase.category}</td>
                                                            <td className="px-4 py-3">{useCase.name}</td>
                                                            <td className="px-4 py-3 capitalize">{useCase.channel}</td>
                                                            <td className="px-4 py-3">
                                                                <select
                                                                    value={useCase.specialGroup || ''}
                                                                    onChange={(e) => {
                                                                        setUseCases(useCases.map(uc => 
                                                                            uc.id === useCase.id 
                                                                                ? {...uc, specialGroup: e.target.value || null}
                                                                                : uc
                                                                        ));
                                                                    }}
                                                                    className="text-xs border rounded px-1 py-0.5"
                                                                >
                                                                    <option value="">None</option>
                                                                    {Object.keys(specialGroups).map(group => (
                                                                        <option key={group} value={group}>{group}</option>
                                                                    ))}
                                                                </select>
                                                            </td>
                                                            <td className="px-4 py-3">{useCase.metric}</td>
                                                            <td className="px-4 py-3">
                                                                <input
                                                                    type="number"
                                                                    value={useCase.baselineValue}
                                                                    onChange={(e) => {
                                                                        setUseCases(useCases.map(uc => 
                                                                            uc.id === useCase.id 
                                                                                ? {...uc, baselineValue: parseFloat(e.target.value) || 0}
                                                                                : uc
                                                                        ));
                                                                    }}
                                                                    className="w-16 px-2 py-1 border rounded"
                                                                />
                                                            </td>
                                                            {months.map(month => {
                                                                const monthData = useCase.data[month.id] || {};
                                                                const savings = calculateSavings(useCase, month.id);
                                                                
                                                                return (
                                                                    <td key={month.id} className="px-2 py-2">
                                                                        <div className="space-y-1">
                                                                            <input
                                                                                type="number"
                                                                                placeholder="Volume"
                                                                                value={monthData.volume || ''}
                                                                                onChange={(e) => updateUseCaseData(useCase.id, month.id, 'volume', e.target.value)}
                                                                                className="w-full px-2 py-1 text-xs border rounded"
                                                                            />
                                                                            <input
                                                                                type="number"
                                                                                placeholder={useCase.metric.includes('min') ? 'Minutes' : '%'}
                                                                                value={monthData.improvement || ''}
                                                                                onChange={(e) => updateUseCaseData(useCase.id, month.id, 'improvement', e.target.value)}
                                                                                className="w-full px-2 py-1 text-xs border rounded"
                                                                            />
                                                                            <div className="text-xs font-bold text-green-600">
                                                                                ${Math.round(savings).toLocaleString()}
                                                                            </div>
                                                                        </div>
                                                                    </td>
                                                                );
                                                            })}
                                                            <td className="px-4 py-3 font-bold text-green-600">
                                                                ${Math.round(totalSavings).toLocaleString()}
                                                            </td>
                                                            <td className="px-4 py-3">
                                                                <button
                                                                    onClick={() => removeUseCase(useCase.id)}
                                                                    className="text-red-600 hover:text-red-800"
                                                                >
                                                                    <Icons.Trash />
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    {/* Add Controls */}
                                    <div className="bg-gray-100 px-6 py-4">
                                        <button
                                            onClick={() => setShowAddUseCase(!showAddUseCase)}
                                            className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                                        >
                                            <Icons.Plus /> Add Use Case
                                        </button>
                                    </div>
                                    
                                    {/* Add Use Case Form */}
                                    {showAddUseCase && (
                                        <div className="bg-blue-50 px-6 py-4">
                                            <div className="grid grid-cols-6 gap-3">
                                                <select
                                                    value={newUseCase.category}
                                                    onChange={(e) => setNewUseCase({...newUseCase, category: e.target.value})}
                                                    className="px-3 py-2 border rounded"
                                                >
                                                    <option value="Pre-Sales">Pre-Sales</option>
                                                    <option value="Order Support">Order Support</option>
                                                    <option value="Technical Support">Technical Support</option>
                                                    <option value="Customer Service">Customer Service</option>
                                                </select>
                                                <input
                                                    type="text"
                                                    placeholder="Use Case Name"
                                                    value={newUseCase.name}
                                                    onChange={(e) => setNewUseCase({...newUseCase, name: e.target.value})}
                                                    className="px-3 py-2 border rounded"
                                                />
                                                <select
                                                    value={newUseCase.channel}
                                                    onChange={(e) => setNewUseCase({...newUseCase, channel: e.target.value})}
                                                    className="px-3 py-2 border rounded"
                                                >
                                                    <option value="phone">Phone</option>
                                                    <option value="chat">Chat</option>
                                                    <option value="email">Email</option>
                                                    <option value="social">Social</option>
                                                    <option value="bot">Bot</option>
                                                </select>
                                                <select
                                                    value={newUseCase.specialGroup || ''}
                                                    onChange={(e) => setNewUseCase({...newUseCase, specialGroup: e.target.value || null})}
                                                    className="px-3 py-2 border rounded"
                                                >
                                                    <option value="">No Special Group</option>
                                                    {Object.keys(specialGroups).map(group => (
                                                        <option key={group} value={group}>{group}</option>
                                                    ))}
                                                </select>
                                                <select
                                                    value={newUseCase.metric}
                                                    onChange={(e) => setNewUseCase({...newUseCase, metric: e.target.value})}
                                                    className="px-3 py-2 border rounded"
                                                >
                                                    <option value="Deflection Rate (%)">Deflection Rate (%)</option>
                                                    <option value="AHT Reduction (min)">AHT Reduction (min)</option>
                                                    <option value="Automation Rate (%)">Automation Rate (%)</option>
                                                    <option value="Self-Service Resolution (%)">Self-Service Resolution (%)</option>
                                                    <option value="Transfer Rate Reduction (%)">Transfer Rate Reduction (%)</option>
                                                </select>
                                                <button
                                                    onClick={addUseCase}
                                                    className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
                                                >
                                                    Add
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </>
                        )}

                        {/* Analytics Tab */}
                        {activeTab === 'analytics' && (
                            <div className="space-y-6">
                                {/* Analytics Date Range Selector */}
                                <div className="bg-white rounded-lg shadow-lg p-4">
                                    <h3 className="font-semibold mb-3 flex items-center gap-2">
                                        <Icons.Calendar /> Analytics Date Range
                                    </h3>
                                    <div className="date-range-picker">
                                        <div className="date-input-group">
                                            <label className="date-label">Start Month</label>
                                            <input
                                                type="month"
                                                value={analyticsDateRange.start}
                                                onChange={(e) => setAnalyticsDateRange({ ...analyticsDateRange, start: e.target.value })}
                                                className="date-input"
                                            />
                                        </div>
                                        <div className="date-input-group">
                                            <label className="date-label">End Month</label>
                                            <input
                                                type="month"
                                                value={analyticsDateRange.end}
                                                onChange={(e) => setAnalyticsDateRange({ ...analyticsDateRange, end: e.target.value })}
                                                className="date-input"
                                            />
                                        </div>
                                        <div className="flex items-end">
                                            <div className="px-4 py-2 bg-blue-100 text-blue-700 rounded">
                                                Analyzing {getFilteredMonths().length} months
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Charts */}
                                <div className="grid grid-cols-2 gap-6">
                                    <div className="bg-white rounded-lg shadow-lg p-6">
                                        <h3 className="text-lg font-semibold mb-4">Monthly Savings Trend</h3>
                                        <div className="chart-container">
                                            <canvas ref={chartRefs.monthly}></canvas>
                                        </div>
                                    </div>
                                    <div className="bg-white rounded-lg shadow-lg p-6">
                                        <h3 className="text-lg font-semibold mb-4">Cumulative Savings</h3>
                                        <div className="chart-container">
                                            <canvas ref={chartRefs.cumulative}></canvas>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="grid grid-cols-2 gap-6">
                                    <div className="bg-white rounded-lg shadow-lg p-6">
                                        <h3 className="text-lg font-semibold mb-4">Savings by Category</h3>
                                        <div className="chart-container">
                                            <canvas ref={chartRefs.category}></canvas>
                                        </div>
                                    </div>
                                    <div className="bg-white rounded-lg shadow-lg p-6">
                                        <h3 className="text-lg font-semibold mb-4">Channel Performance</h3>
                                        <div className="chart-container">
                                            <canvas ref={chartRefs.channel}></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Guidance Tab */}
                        {activeTab === 'guidance' && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-lg shadow-lg p-6">
                                    <h2 className="text-2xl font-bold mb-4">Input Guidance</h2>
                                    <div className="grid grid-cols-1 gap-4">
                                        {Object.keys(InputGuidance).map((metric) => (
                                            <div
                                                key={metric}
                                                className="guidance-card cursor-pointer hover:shadow-lg transition-shadow"
                                                onClick={() => {
                                                    setSelectedMetricGuide(metric);
                                                    setShowGuidanceModal(true);
                                                }}
                                            >
                                                <div className="flex justify-between items-center">
                                                    <div>
                                                        <div className="guidance-title">{metric}</div>
                                                        <div className="guidance-content">
                                                            <p className="mb-2">{InputGuidance[metric].baseline.description}</p>
                                                        </div>
                                                    </div>
                                                    <Icons.Info />
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* Guidance Modal */}
                    <GuidanceModal />
                </div>
            );
        };

        // Render the application
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AIValueCalculator />);
    </script>
</body>
</html>
